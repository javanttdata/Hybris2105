!function(t){var e={};function n(r){if(e[r])return e[r].exports;var a=e[r]={i:r,l:!1,exports:{}};return t[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(r,a,function(e){return t[e]}.bind(null,a));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e){t.exports=jQuery},function(t,e,n){t.exports=n(2)},function(t,e,n){"use strict";n.r(e);function r(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]}var a=/^(%20|\s)*(javascript|data|vbscript)/im,i=/[^\x20-\x7EÀ-ž]/gim,o=/^([^:]+):/gm,s=[".","/"];function d(t){if(!t)return"#";var e=t.replace(i,"").trim();if(function(t){return s.indexOf(t[0])>-1}(e))return e;var n=e.match(o);if(!n)return e;var r=n[0];return a.test(r)?"#":e}var c,u=n(0),l=function(){function t(e,n,r){this.tenant=this._getTenantId(),this.strategy=e,this.numberToDisplay=r,this.category=this._getCategory(),this.facets=this._getFacets(),this.siteId=this._getSiteId(),this.language=this._getLanguage(),this.productId=this._getProductId(),this.url=this._buildUrl(n),this.consentReference=window.localStorage.getItem(t.CONSENT_REFERENCE)}return t.prototype.getProducts=function(){var t=this.consentReference?{"consent-reference":this.consentReference}:null;return u.ajax({type:"GET",url:this.url,headers:t})},t.prototype._buildUrl=function(t){var e=null;if(!this.strategy||!this.tenant)return null;e=t+"/"+encodeURIComponent(this.tenant)+"/strategies/"+encodeURIComponent(this.strategy)+"/products";var n="";return this.category&&(n=this._buildQueryString(n,"category="+encodeURIComponent(this.category))),this.facets&&(n=this._buildQueryString(n,"facets="+encodeURIComponent(this.facets))),this.numberToDisplay&&(n=this._buildQueryString(n,"pageSize="+encodeURIComponent(this.numberToDisplay))),this.siteId&&(n=this._buildQueryString(n,"site="+encodeURIComponent(this.siteId))),this.language&&(n=this._buildQueryString(n,"language="+encodeURIComponent(this.language))),this.productId&&(n=this._buildQueryString(n,"products="+encodeURIComponent(this.productId))),n&&(e=e+"?"+n),e},t.prototype._buildQueryString=function(t,e){return t&&(t+="&"),t+=e},t.prototype._getTenantId=function(){var t=null;try{t=JSON.parse(ACC.addons.merchandisingaddon.hybrisTenant).properties.hybrisTenant}catch(t){r("JSON parser error",t)}return t},t.prototype._getCategory=function(){var t=null;try{if(ACC.addons.merchandisingaddon.ItemCategory)t=JSON.parse(ACC.addons.merchandisingaddon.ItemCategory).properties.ItemCategory}catch(t){r("JSON parser error",t)}return t},t.prototype._getProductId=function(){var t=null;try{t=JSON.parse(ACC.addons.merchandisingaddon.product).properties.product}catch(t){r("JSON parser error",t)}return t},t.prototype._getFacets=function(){var t=null;try{if(ACC.addons.merchandisingaddon.ContextFacets){var e=JSON.parse(ACC.addons.merchandisingaddon.ContextFacets);t="",e.properties.ContextFacets.forEach((function(e){e.values.forEach((function(n){t+=e.code+":"+n+":"}))}))}}catch(t){r("JSON parser error",t)}return t},t.prototype._getSiteId=function(){var t=null;try{t=JSON.parse(ACC.addons.merchandisingaddon.siteId).properties.siteId}catch(t){r("JSON parser error",t)}return t},t.prototype._getLanguage=function(){var t=null;try{t=JSON.parse(ACC.addons.merchandisingaddon.language).properties.language}catch(t){r("JSON parser error",t)}return t},t.prototype.setConsentReference=function(e){this.consentReference=e,window.localStorage.setItem(t.CONSENT_REFERENCE,e)},t.CONSENT_REFERENCE="merchandising-consent-reference",t}(),p=(c=function(t,e){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}c(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),h=function(t,e){this.name=t,this.data=e},g=function(){function t(t){this.data=t}return t.prototype.getData=function(){return this.data},t}(),m=function(t){function e(e,n,r){var a=t.call(this,e)||this;return a.slot=n,a.productId=r,a}return p(e,t),e.prototype.getSlot=function(){return this.slot},e.prototype.getProductId=function(){return this.productId},e}(g),f=function(){function t(){var t=this;this.handleViewEvent=function(e){var n=e.getData(),r=n.items.map((function(t){return t.id})),a={carouselId:n.carouselId,strategyId:n.strategy,productSkus:r,metadata:n.metadata,carouselName:n.name},i=new h("CarouselViewed",a);t.pushEvent(i)},this.handleClickEvent=function(e){var n=e.getData(),r=n.items.filter((function(t){return t.id===e.getProductId()})).map((function(t){return t.thumbnailImage}))[0],a={carouselId:n.carouselId,strategyId:n.strategy,slotId:e.getSlot(),sku:e.getProductId(),imageUrl:r,carouselName:n.name,metadata:n.metadata},i=new h("CarouselClicked",a);t.pushEvent(i)},this.pushEvent=function(t){window.Y_TRACKING&&window.Y_TRACKING.eventLayer&&window.Y_TRACKING.eventLayer.push(t)}}return t.prototype.initialize=function(){var t=this;window.addEventListener("cds.merchandising.carouselViewed",(function(e){t.handleViewEvent(e.detail)})),window.addEventListener("cds.merchandising.carouselClicked",(function(e){t.handleClickEvent(e.detail)}))},t}();(function(){function t(t){var e=t.el,n=t.data,r=void 0===n?{}:n;this.metadata={},this.defaultViewportPercentage=80,this.$el=u(e),this.data=r}return t.prototype.render=function(){r("render",this.data),this.$el.empty().append(this.getHtml()).find(".js-merch-carousel").owlCarousel({scrollPerPage:"ALLVISIBLE"===this.data.scroll,navigation:!0,navigationText:["<span class='glyphicon glyphicon-chevron-left'></span>","<span class='glyphicon glyphicon-chevron-right'></span>"],pagination:!1,itemsCustom:[[0,2],[640,4],[1024,5],[1400,7]]}),this.registerIntersectionObserver()},t.prototype.registerIntersectionObserver=function(){var e=this.data.viewportpercentage?this.data.viewportpercentage:this.defaultViewportPercentage,n=new IntersectionObserver((function(e,n){e.filter((function(t){return t.intersectionRatio>0})).forEach((function(e){var r=new g(window.__merchcarousels[e.target.id].data);t.raiseEvent("cds.merchandising.carouselViewed",r),n.unobserve(document.getElementById(e.target.id))}))}),{root:null,rootMargin:"0px",threshold:e/100}),r=document.getElementById(this.data.carouselId);n.observe(r)},t.raiseEvent=function(t,e){var n=new CustomEvent(t,{detail:e});window.dispatchEvent(n)},t.onClick=function(e,n,r){var a=window.__merchcarousels[e],i=new m(a.data,r,n);t.raiseEvent("cds.merchandising.carouselClicked",i)},t.prototype.getHtml=function(){var t=this,e=this.data,n=e.backgroundcolour,r=e.textcolour,a={},i={},o="carousel__item--name",s="carousel__item--price";r&&(a.color=r),n&&(i["background-color"]=n,o+=" merchcarousel_custom-color",s+=" merchcarousel_custom-color");var c=this.data.items.reduce((function(e,n,r){return e.add(u("<div>").addClass("carousel__item").click((function(){return window.__merchcarousels.CarouselComponent.onClick(t.data.carouselId,n.id,r+1)})).append(u("<a>").attr("href",d(n.pageUrl)).append(u("<div>").addClass("carousel__item--thumb").append(u("<img>").attr("src",d(n.mainImage)).attr("alt",n.name).attr("title",n.name))).append(u("<div>").addClass(o).css(a).text(n.name)).append(u("<div>").addClass(s).css(a).text(t.data.currency+n.price))).append(u("<div>").attr("id","data-merchandising-product-"+n.id).addClass("data-merchandising-product").attr(function(t,e){var n={"data-merchandising-product-id":t.id,"data-merchandising-product-slot":e};if(t.metadata)for(var r in t.metadata){var a=t.metadata[r];n["data-merchandising-product-"+r]=a}return n}(n,r+1))))}),u());if(this.metadata["data-merchandising-carousel-title"]=this.data.title||"",this.metadata["data-merchandising-carousel-name"]=this.data.name||"undefined",this.metadata["data-merchandising-carousel-strategyid"]=this.data.strategy||"undefined",this.metadata["data-merchandising-carousel-id"]=this.data.carouselId||"undefined",this.metadata["data-merchandising-carousel-slots"]=this.data.items.length,this.data&&this.data.metadata)for(var l in this.data.metadata){var p=this.data.metadata[l];this.metadata["data-merchandising-carousel-"+l]=p}return u("<div>").addClass("carousel__component merchandising-carousel").css(i).append(u("<div>").addClass("carousel__component--headline").css(a).text(this.data.title)).append(u("<div>").addClass("carousel__component--carousel js-merch-carousel").append(c)).append(u("<div>").attr("id","data-merchandising-carousel-"+this.data.carouselId).addClass("data-merchandising-carousel").attr(this.metadata))},t.init=function(){r("init"),(new f).initialize(),Object.keys(window.__merchcarousels||{}).forEach((function(e){var n=window.__merchcarousels[e],a=n.el,i=n.inited;n.data;if(a&&!i){var o=a.dataset,s=o.numbertodisplay,d=o.title,c=o.name,p=o.currency,h=o.strategy,g=o.scroll,m=o.url,f=o.backgroundcolour,v=o.textcolour,y=o.viewportpercentage,_=+s;n.inited=!0;var C=new l(h,m,_);window.addEventListener("profiletag_consentReferenceLoaded",(function(t){r("profiletag_consentReferenceLoaded",t),C.setConsentReference(t.detail.consentReference)})),r("inited"),C.getProducts().then((function(n){r("data received",n);var i,o=null;n&&n.products&&(o=0!==_?n.products.slice(0,_):n.products),n&&n.metadata&&(i=n.metadata),r("numbertodisplay",_),r("items",o);var s={scroll:g,items:o,title:d,name:c,currency:p,backgroundcolour:f,textcolour:v,strategy:h,carouselId:e,metadata:i,viewportpercentage:y};o&&o.length&&null!=u.fn.owlCarousel&&(new t({el:a,data:s}).render(),window.__merchcarousels[e].data=s,r("rendered"))}))}})),window.__merchcarousels=window.__merchcarousels||{},window.__merchcarousels.CarouselComponent=t},t})().init()}]);